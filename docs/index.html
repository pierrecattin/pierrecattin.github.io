<html>
<head>

<style type="text/css">

* {
	font-family: Arial;
}
a.sobre 
	{
	color:white;
	text-decoration:none;
	}
a.sobre:visited
	{
	color:white;
	text-decoration:none;
	}

</style>

<script type='text/Javascript'>

//déclaration des variables qui seront utilisées dans plusieurs fonctions
var niveau;
var fautes;
var taille;
var valeurArmure;

var chrono=0;
var piece=0; //"piece" et "carreau" sont les deux seuls objets(littéralement)  qui ne sont pas des booleans; on peut en posséder plusieurs exemplaires

var carreau=0;
valeurArmure=0;
var tempsSup=0;
var fautesMax=2;
var temps=15;
var diff="facile";


//ces boolean désignent des objets (littéralement, pas la signification javascript)
var arbalete=new Boolean;
var dague=new Boolean;
var claymore=new Boolean;
var ralentisseur=new Boolean;
var armFer=new Boolean;
var armDae=new Boolean;
var doomsDayMachine=new Boolean;


//false signifie qu'on ne possède pas l'objet
arbalete=false;
claymore=false;
dague=false;
ralentisseur=false;
armFer=false;
armDae=false;
doomsDayMachine=false;


tableau=new Array();


lettre=['A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z'];

//mot=['DAEDRIQUE','VIVEC','DRAGON','NEREVARINE', 'MORROWIND', 'GUILDE', 'BALMORA'];

mot=['HORSE','MOUNTAIN','STATISTICS','BLOOD', 'EXTREME', 'SNOWBOARD', 'CRAZY', 'DELICIOUS', 'MUSIC', 'BEAUTIFUL', 'OCEAN', 'REALLY', 'LAZINESS', 'GIANT', 'UNIVERSITY', 'GEOGRAPHY', 'MATHEMATICS'];




function afficherAccueil()//fonction qui est utilisée l'ouverture de la page et à la fin de chaque partie. elle affiche l'image centrale, le choix de difficulté, et le lien vers les instructions
	{
	document.getElementById("horloge").value="Menu";

	//ces 3 variables  varient à chaque niveau: quand on revient à l'accueil, il faut les réinitialiser
	niveau=0;
	fautes=0;
	taille=4;

	afficherInventaire();
	
	//le html de l'accueil sera stocké dans la variable contenuAccueil
	contenuAccueil="<font color='white' size=3><a href='#' onClick='levelUp();'>";
	contenuAccueil+="<img src='Dragon.jpg' border=0 height=200>";
	contenuAccueil+="</a>";
	contenuAccueil+="<br><br><br><br><form name='choix'> 	<input type='radio' name='difficulte'";

	if (diff=="facile") //pour que la difficulté séléctionnée par défaut soit celle de la partie précédente 
		{
		contenuAccueil+="checked='yes'";
		}

	contenuAccueil+=">facile |difficile";

	contenuAccueil+="<input type='radio' name='difficulte'";

		if (diff=="difficile")
		{
		contenuAccueil+="checked='yes'";
		}
	contenuAccueil+=">";
	contenuAccueil+="</form>";
	contenuAccueil+='<br><br><a href="Javascript:alert(&#34Vous devez trouver des mots d\&#39au moins 4 lettres en rapport avec l\&#39univers d\&#39Elder Scrolls. Cliquez sur la première lettre du mot pour le sélectionner. Vous n\&#39avez droit qu\&#39à 2 essais par niveau. En mode difficile, les mots peuvent être disposés verticalement, mais vous gagnez plus de pièces d\&#39or. Les armes permettent de supprimer des lettres, les armures permettent de dépasser le temps imparti, et le sablier ralenti le temps. Cliquez sur l\&#39image pour commencer.&#34)"><u><font color="white">Instructions</font></u></a>';
	contenuAccueil+="</font>";
	
	//"copierAccueil"est un div du même type que le div à l'id "contenu", qui se trouve dans le body
	copierAccueil=document.getElementById("contenu").cloneNode(true);

	//on met le HTML stocké dans "contenuAccueil" dans "contenuAccueil"
	copierAccueil.innerHTML=contenuAccueil;

	//on affiche "copierAccueil" dans le div "contenu".
	document.body.appendChild(copierAccueil);
	}

function afficherInventaire()//affiche le magasin et les objets achetés
	{
	contenuMagasin="<font color='white'>Pièces d'or:<br>";
	contenuMagasin+=piece;


	if (arbalete==false)
		{
		contenuMagasin+="<br><br><br><a href='#' onClick='acheter(&#39arba&#39)' class='sobre'>Acheter l'arbalète : 50 po</a>";
		}
	
	else  //quand on possède l'arbalète, le lien pour l'acheter est remplacé par un lien pour acheter des carreaux
		{
		contenuMagasin+="<br><br><br><a href='#' onClick='acheter(&#39carr&#39)' class='sobre'>Acheter deux carreaux : 5 po</a>";
		}



	if (dague==false)
		{
		contenuMagasin+="<br><br><a href='#' onClick='acheter(&#39dag&#39)' class='sobre'>Acheter la dague : 200 po</a>";
		}
	
	else  //quand on possède la dague, il faut le remplacer le lien pour l'acheter par des alinéas pour ne pas perturber la mise en page.
		{
		contenuMagasin+="<br><br>";
		}



	if (claymore==false)
		{
		contenuMagasin+="<br><br><a href='#' onClick='acheter(&#39clay&#39)' class='sobre'>Acheter la claymore : 1000 po</a>";
		}
	else
		{
		contenuMagasin+="<br><br>";
		}



	if (armFer==false)
		{
		contenuMagasin+="<br><br><a href='#' onClick='acheter(&#39fer&#39)' class='sobre'>Acheter l'armure de chitine : 100 po</a>";
		}



	if (armFer==true && armDae==false)  //le lien ne doit s'afficher que quand on possède uniquement l'armure de chitine.
		{
		contenuMagasin+="<br><br><a href='#' onClick='acheter(&#39dae&#39)' class='sobre'>acheter l'armure daédrique : 200 po</a>";
		}
	else if(armDae==true)  //il faut mettre un espace quand on possède les deux armures

		{
		contenuMagasin+="<br><br>";
		}


	if (ralentisseur==false)
		{
		contenuMagasin+="<br><br><a href='#' onClick='acheter(&#39horlo&#39)' class='sobre'>Acheter le sablier : 600 po</a>";
		}
	else
		{
		contenuMagasin+="<br><br>";
		}


		
	contenuMagasin+="</font>";
	//on affiche le magasin, avec la méthode expliquée précédemment
	copierMagasin=document.getElementById("magasin").cloneNode(true);
	copierMagasin.innerHTML=contenuMagasin;
	document.body.appendChild(copierMagasin);

	//affichage des images correspondantes aux armes
	contenuInventaire="<center>";
	if (arbalete==true)
		{
		contenuInventaire+="<center><font color='white'><img src='Arbalète.jpg' height='75'><br>"+carreau+" carreaux</font>";
		}
	else //de nouveau, un espace pour la mise en page
		{
		contenuInventaire+="<br><br><br><br>";
		}

	if (dague==true)
		{
		contenuInventaire+="<center><img src='Dague.jpg' height='75'><br>";
		}
	else
		{
		contenuInventaire+="<br><br><br><br>";
		}

	if (claymore==true)
		{
		contenuInventaire+="<center><img src='Claymore.jpg' height='75'><br>";
		}
	else
		{
		contenuInventaire+="<br><br><br><br>";
		}



	if (armFer==true &&armDae==false)//l'image de l'armure faible(chitine) s'enlève quand on achète la meilleure(daédrique)
		{
		contenuInventaire+="<img src='Chitine.jpg' height='75'><br>";
		}
	else if(armDae==false)
		{
		contenuInventaire+="<br><br><br><br><br>";
		}



	if (armDae==true)
		{
		contenuInventaire+="<img src='Daedrique.jpg' height='75'><br>";
		}



	if (ralentisseur==true)
		{
		contenuInventaire+="<img src='Sablier.jpg' height='75'>";
		}

	else
		{
		contenuInventaire+="<br><br><br><br><br>";
		}


	contenuInventaire+="</center>";

	copierInventaire=document.getElementById("inventaire").cloneNode(true);
	copierInventaire.innerHTML=contenuInventaire;
	document.body.appendChild(copierInventaire);
	
	}

function acheter(arme)//les transactions sont effectuées dans cette fonction
	{
	switch(arme)
		{
		case "arba":
			if(piece>=50)
				{
				arbalete=true;
				piece=piece-50;
				}
			else
				{
				alert("Vous n'avez pas assez d'or.");
				}
		break;

		case "dag":
			if(piece>=200)
				{
				dague=true;
				piece=piece-200;
				}
			else
				{
				alert("Vous n'avez pas assez d'or.");
				}
		break;

		case "clay":
			if(piece>=1000)
				{
				claymore=true;
				piece=piece-1000;
				}
			else
				{
				alert("Vous n'avez pas assez d'or.");
				}
		break;

		case "carr":
			if(piece>=5)
				{
				carreau=carreau+2;
				piece=piece-5;
				}
			else
				{
				alert("Vous n'avez pas assez d'or.");
				}
		break;

		case "fer":
			if(piece>=100)
				{
				piece=piece-100;
				armFer=true;
				valeurArmure=valeurArmure+9;
				}
			else
				{
				alert("Vous n'avez pas assez d'or.");
				}
		break;

		case "dae":
			if(piece>=200)
				{
				piece=piece-200;
				armDae=true;
				valeurArmure=valeurArmure+6;
				}
			else
				{
				alert("Vous n'avez pas assez d'or.");
				}

		break;

		case "horlo":
			if(piece>=600)
				{
				ralentisseur=true;
				piece=piece-600;
				}
			else
				{
				alert("Vous n'avez pas assez d'or.");
				}
		break;
		}

	//après avoir acheté un objet, il faut mettre à jour l'inventaire du magasin
	document.body.removeChild(copierAccueil);	//le contenu de l'accueil(image, difficulté,...) est enlevé de la page...
	document.body.removeChild(copierMagasin);	//de meme que le magasin...
	document.body.removeChild(copierInventaire);	//et l'inventaire
	afficherInventaire();				//puis on recalcule l'inventaire et le magasin pour les mettre à jour(l'affichage est inclu dans la fonction)
	document.body.appendChild(copierAccueil);	//finalement,  on réaffiche l'accueil, qui doit etre affiché après l'inventaire, pour la mise en page
	}


function levelUp()//passage de niveau
	{
	if (niveau==41 && doomsDayMachine==false)//la surprise du niveau 42
		{
		alert("Vous êtes arrivés au niveau 42. Vous avez débloqué la Machine du Jugement Dernier.");
		doomsDayMachine=true;
		chrono=-1000;
		piece=42000000;
		document.body.removeChild(copierTableau);
		document.body.removeChild(copierArme);
		afficherAccueil();
		}
	else
		{
		taille++;
		niveau++;
		if(niveau==1)						//au premier niveau certaines dispositions doivent etre prises:
			{
			if(document.forms.choix.difficulte[0].checked)	//il faut récupérer le choix de la difficulté, avant que le formulaire de l'accueil soit enlevé...
				{
				diff="facile";
				}
			else
				{
				diff="difficile";
				}
			document.body.removeChild(copierAccueil);	//enlever l'accueil, l'inventaire et le magasin...
			document.body.removeChild(copierInventaire);	
			document.body.removeChild(copierMagasin);
			alert("Niveau 1");
			chrono=temps;					//définir la valeur de départ du chronographe par rapport au temps de base...
			compteur();					//et lancer le compteur de temps
			}
		else//cas ou l'on est pas au premier niveau
			{
			tempsSup=Math.abs(Math.round(chrono*0.75));	//une partie du temps restant du niveau précédent
			chrono=temps+tempsSup;				//est rajoutée au temps de base
			alert("C\'est juste. Vous passez au niveau "+niveau);
			document.body.removeChild(copierTableau);
			document.body.removeChild(copierArme);
			}
		fautes=0;	//la faute éventuelle est suprimée
		generation(); //le tableau est créé
		inserer();	//et un mot y est placé
		}
	}




function generation()
	{
	for(var i=0;i<taille;i++)//génération du tableau virtuel rempli de lettres disposées aléatoirement
		{
		tableau[i]=new Array();
		for(var j=0;j<taille;j++)
			{
			tableau[i][j]=lettre[Math.floor(Math.random()*26)];
			}
		}
	
	//affichage du tableau
	copierTableau=document.getElementById("contenu").cloneNode(true);
	toutLeTableau = '<center><table id="tabl" border=1>';

	for(var i=0;i<taille;i++)
		{
		toutLeTableau += '<tr>';
		for(var j=0;j<taille;j++)
			{
			toutLeTableau += '<td id="'+i+'-'+j+'">';
			toutLeTableau += "<a id='pasmot' href='#' onClick='faux();'class='sobre'>"+tableau[i][j]+"</a>";//chaque lettre est un lien qui n'est pas la réponse correcte; celle-ci sera placée plus tard
			toutLeTableau += "</td>";
			}
		toutLeTableau += "</tr>";
		}
	toutLeTableau += "</table></center>";

	copierTableau.innerHTML = toutLeTableau;
	document.body.appendChild(copierTableau);
	afficherArme();
	}

function afficherArme()//cette fonction affiche les boutons permettant d'utiliser les armes
	{
	copierArme=document.getElementById("contenu").cloneNode(true);

	toutArme="<br><font color='white'>";
	if (arbalete==true && carreau>0)//quand il ne reste plus de carreaux, le bouton disparait.
		{
		toutArme+="<button onClick=shot('arba',5)>Tirer un carreau ( "+carreau+" carreaux restants)</button>";//le bouton est modifié en fonction du nombre de carreaux restants
		}
	
	if (dague==true)
		{
		toutArme+="<button onClick=shot('',1)>Coup de dague</button>";
		}

	if (claymore==true)
		{
		toutArme+="<button onClick=shot('',3)>Coup de claymore</button>";
		}
	

	if (doomsDayMachine==true)
		{
		toutArme+="<a href='#' onClick='shot(&#39&#39,5000)'><img src='http://rlv.zcache.com/yellow_nuke_poster-p228219752585451452t5wm_400.jpg' height='60' border='0'></a>";
		}
	toutArme+="</font>";
	copierArme.innerHTML=toutArme;
	document.body.appendChild(copierArme);
		}




function inserer()
	{
	do //on recherche un mot pas plus long que le tableau
		{
		motAInserer=mot[Math.floor(Math.random()*mot.length)];
		}
	while(motAInserer.length>taille)	

	if(diff=="facile")
		{
		direction=0;
		}
	else
		{
		direction=Math.round(Math.random());//en mode difficile, le mot est placé verticalement un fois sur 2
		}

	if(direction==0)
		{
		debutX=Math.floor(Math.random()*(taille-motAInserer.length+1));//on définit la position de la première lettre 
		debutY=Math.floor(Math.random()*taille);

		for(i=0;i<motAInserer.length;i++)
			{
			if(i==0)//horizontal
				{
				document.getElementById(debutY+"-"+debutX).innerHTML="<a id='mot' href='#' onClick='levelUp();' class='sobre'>"+motAInserer.charAt(i)+"</a>";//la première lettre est le seul lien correct(qui lance levelUp() )
				}
			else
				{
				document.getElementById(debutY+"-"+(debutX+i)).innerHTML="<a id='mot' href='#' onClick='faux();'class='sobre'>"+motAInserer.charAt(i)+"</a>"; 	//pour les autres lettres du mot, le lien lance faux()
							//les id des liens des lettres du mot sont appelés "mot", pour qu'on puisse les reconnaitre plus tard, dans la fonction shot()
				}
			}
		}
	if(direction==1)//vertical
		{
		debutX=Math.floor(Math.random()*taille);
		debutY=Math.floor(Math.random()*(taille-motAInserer.length+1));
		for(i=0;i<motAInserer.length;i++)
			{
			if(i==0)
				{
				document.getElementById(debutY+"-"+debutX).innerHTML="<a id='lettre' href='#' onClick='levelUp();'class='sobre' >"+motAInserer.charAt(i)+"</a>";
				}
			else
				{
				document.getElementById((debutY+i)+"-"+debutX).innerHTML="<a id='lettre' href='#' onClick='faux();'class='sobre'>"+motAInserer.charAt(i)+"</a>";
				}
			}


		}

	}


function shot(arme, puissance)//le paramètre "arme" et seulement utilisé pour savoir s'il faut enlever un carreau
	{

		j=0;
	
		for(i=0;i<puissance;i++)
			{
			j++;
			posX=Math.floor(Math.random()*taille);//choisit une lettre aléatoirement
			posY=Math.floor(Math.random()*taille);
			if(document.getElementById(posY+"-"+posX).getElementsByTagName("a")[0].getAttribute("id") == "pasmot")//vérifie si la lettre ne fait pas partie du mot, et si elle n'a pas déjà été supprimée
				{
				document.getElementById(posY+"-"+posX).innerHTML="<a id='dejasupprime'>00</a>";//met "00" en noir dans la case, et change l'id
				}
			else
				{
				i=i-1; //si l'on passe par ici, aucune lettre n'a été supprimée, il faut donc faire un tour de plus pour commpenser cette perte
				}
			if(j>500) i=99999;//pour éviter une boucle infinie quand il ne reste plus de lettre à supprimer
			}
		if(arme=="arba")
			{
			carreau=carreau-1;
			document.body.removeChild(copierArme);
			afficherArme();//si on a utilisé un carreau, il faut mettre le bouton à jour en réaffichant les armes
			}
		
		
		
	}



function faux()
	{

	fautes++;
	if(fautes==fautesMax)
		{
		if (diff=="facile")
			{
			pieceSup=Math.round(niveau*niveau);//les gains augmentent exponentiellement en fonction du niveau
			}
		else
			{
			pieceSup=niveau*niveau*2;//on gagne plus  de pièce en mode difficile
			}
		piece=piece+pieceSup;
		alert("Vous avez échoué au niveau "+niveau+" en mode "+diff+". Vous gagnez "+pieceSup+" pièces d'or");
		chrono=-1000;//pour arreter le compteur si l'on a pas perdu à cause du chrono
		document.body.removeChild(copierTableau);
		document.body.removeChild(copierArme);

		afficherAccueil();//fin de la partie; il faut réafficher l'accueil
		
		}
	}


function compteur()
	{

	document.getElementById("horloge").value=chrono;
	chrono=chrono-1;
	tempsMin=(-1-valeurArmure);//avec une armure, on peut descendre dans les négatifs 
	if(ralentisseur==false)
		{
		delai=1000;
		}
	else	
		{
		delai=2000;//le ralentisseur(sablier) ralentit le temps
		}
	if(chrono>=(tempsMin+1))
		{
		setTimeout("compteur()",delai);//s'il reste du temps, on relance la fonction avec un delai
		}
	else if(chrono==tempsMin)
		{
		fautes=(fautesMax-1);
		faux();//s'il n'en reste plus, on lance la fonction faux avec un nombre de faute qui fait qu'on a perdu la partie
		}
	else
		{
		document.getElementById("horloge").value="Menu";//si le temps vaut -1001, on affiche "menu"
		}

}


</script>
</head>





<body onLoad="afficherAccueil();" bgcolor="black">

<script language='Javascript'>
document.write("<center><img src='Skyrim.jpg' border=0></center><br>");
</script>



<div align="center" id="contenu"></div>
<div align="right" id="magasin" style="position:absolute; right:100px"></div>
<div align="right" id="inventaire" style="position:absolute; left:100px"></div>
<center>
<form>
<input type="text" id="horloge">
</form>
</center>
</body>
</html>
			
		
